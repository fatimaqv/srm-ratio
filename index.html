<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Growth Ratio (GR/year)</title>
  <style>
    :root {
      --primary:#004b87;
      --primary-600:#0060b3;
      --ok:#16a34a;
      --warn:#ca8a04;
      --bad:#dc2626;
      --muted:#6b7280;
    }
    body {
      font-family: system-ui, "Segoe UI", sans-serif;
      background-color: #f7f9fc;
      color: #222;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 16px;
    }
    h1 { color: var(--primary); margin: 0 0 .25rem; text-align:center; }
    p  { color: #555; margin: 0 0 1rem; font-size: .95rem; text-align:center; }
    .card {
      background: #fff;
      padding: 1.25rem;
      border-radius: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,.08);
      width: min(420px, 95vw);
    }
    label { display:block; font-weight:600; margin-top:.6rem; }
    input {
      width: 100%; padding: .55rem .6rem; margin-top: .25rem;
      border: 1px solid #cfd6e0; border-radius: 8px; box-sizing: border-box;
      font-size: 1rem;
    }
    .btn-row{ display:flex; gap:.6rem; margin-top:.9rem; }
    .btn{
      flex:1; padding:.7rem .9rem; border:none; border-radius:8px; cursor:pointer;
      font-size:1rem; background:var(--primary); color:#fff;
    }
    .btn.secondary{ background:#e9eef6; color:#163f5f; }
    .btn:hover{ background:var(--primary-600); }
    .btn.secondary:hover{ background:#dfe7f3; }
    .result { margin-top: 1rem; text-align:center; font-weight:700; font-size:1.25rem; }
    .badge  { margin-top: .3rem; text-align:center; font-weight:700; }
    .note   { margin-top: .35rem; font-size: .95rem; color:#444; text-align:center; }
    .disclaimer { margin-top: .9rem; font-size: .8rem; color: var(--muted); text-align:center; }
  </style>
</head>
<body>
  <h1>Growth Ratio (GR/year)</h1>
  <p>Basado en el di√°metro m√°ximo tumoral (MTD)</p>

  <div class="card">
    <label>Fecha inicial (A)</label>
    <input type="date" id="dateA">

    <label>Di√°metro A (cm)</label>
    <input type="number" id="diamA" step="0.01" placeholder="Ej. 2.1">

    <label>Fecha control (B)</label>
    <input type="date" id="dateB">

    <label>Di√°metro B (cm)</label>
    <input type="number" id="diamB" step="0.01" placeholder="Ej. 3.2">

    <div class="btn-row">
      <button class="btn" onclick="calcGR()">Calcular GR/year</button>
      <button class="btn secondary" onclick="resetForm()">Limpiar</button>
    </div>

    <div class="result" id="res">‚Äî</div>
    <div class="badge"  id="badge"></div>
    <div class="note"   id="interpret"></div>

    <div class="disclaimer">
      Validez seg√∫n umbrales internacionales. Esta herramienta no reemplaza el juicio cl√≠nico.
    </div>
  </div>

  <script>
    function todayISO(){
      const t = new Date();
      t.setMinutes(t.getMinutes() - t.getTimezoneOffset());
      return t.toISOString().slice(0,10);
    }
    function setDateMaxToday(){
      const max = todayISO();
      document.getElementById("dateA").max = max;
      document.getElementById("dateB").max = max;
    }
    window.addEventListener('load', setDateMaxToday);

    function monthsBetween(a,b){
      return (b - a) / (1000 * 60 * 60 * 24 * 30.4375);
    }

    function calcGR(){
      const A = parseFloat(document.getElementById("diamA").value);
      const B = parseFloat(document.getElementById("diamB").value);
      const dateA = document.getElementById("dateA").value;
      const dateB = document.getElementById("dateB").value;
      const res = document.getElementById("res");
      const badge = document.getElementById("badge");
      const interp = document.getElementById("interpret");

      badge.textContent=""; badge.style.color=""; interp.textContent="";

      if(!A && A!==0 || !B && B!==0 || !dateA || !dateB){
        res.textContent="Ingrese todos los valores.";
        return;
      }

      const dA = new Date(dateA);
      const dB = new Date(dateB);
      const today = new Date();
      dA.setHours(0,0,0,0); dB.setHours(0,0,0,0); today.setHours(0,0,0,0);

      if(dA > today || dB > today){
        res.textContent="Las fechas no pueden ser futuras.";
        return;
      }
      if(dB <= dA){
        res.textContent="La Fecha B debe ser posterior a la Fecha A.";
        return;
      }

      const meses = monthsBetween(dA,dB);
      const GR = ((B - A)/meses)*12;
      const fmt = (n,d=2)=>Number.isFinite(n)?n.toFixed(d):"‚Äî";
      res.textContent = `GR/year = ${fmt(GR)} cm/a√±o`;

      if(GR <= 0){
        badge.textContent="‚úÖ Estable / disminuye (verde)";
        badge.style.color="#16a34a";
        interp.textContent="Sin crecimiento medible o reducci√≥n del tama√±o. Mantener seguimiento est√°ndar.";
      } else if(GR <= 0.5){
        badge.textContent="‚ö†Ô∏è Crecimiento lento (amarillo)";
        badge.style.color="#ca8a04";
        interp.textContent="Crecimiento bajo. Continuar vigilancia activa seg√∫n calendario habitual.";
      } else {
        badge.textContent="üî¥ Crecimiento significativo (rojo)";
        badge.style.color="#dc2626";
        interp.textContent="Aumento relevante del tama√±o. Considerar reevaluaci√≥n seg√∫n protocolo local.";
      }
    }

    function resetForm(){
      ["diamA","diamB","dateA","dateB"].forEach(id=>document.getElementById(id).value="");
      ["res","badge","interpret"].forEach(id=>document.getElementById(id).textContent="");
    }
  </script>
</body>
</html>
